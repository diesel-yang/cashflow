# 極速記帳 v3.3（build v16.8 完整正式版）

本版本為可立即部署的 **手機優化 PWA 靜態版**，支援「餐廳＋個人（JACK / WAL / 共同 J+W）」共用記帳、分類管理、快捷管理、基本報表與一鍵重置。

---

## 架構
- 純前端（HTML/CSS/JS），可放在 **GitHub Pages / Netlify / Vercel**。
- 資料儲存：瀏覽器 `localStorage`（紀錄、分類、快捷、轉帳）。
- 可離線使用（附 `manifest.json` 與 `sw.js` 範例）。

目錄結構：
```
index.html
style.css
app.js
manifest.json
sw.js
README.md
```

---

## 內建功能總覽
1. **記帳**
   - 對象：餐廳、JACK、WAL、J+W（共同支出）
   - 類型：收入 / 支出
   - 分類：內建完整餐廳常用分類（可自訂新增/刪除）
   - 欄位：金額、備註、報銷標記
2. **轉帳 / 還款**
   - from/to 選擇（餐廳現金/銀行、JACK、WAL）
   - 金額送出即加入轉帳紀錄
3. **報表（本月）**
   - 收入、支出、結餘
   - **明細展開**（可切換）
   - **按類型小計**（可切換；以分類之 type 聚合，例如 cogs/personnel 等）
4. **分類管理**
   - 內建完整餐廳分類（revenue / cogs / personnel / utilities / marketing / logistics / admin / tax / transport / finance / misc）
   - 可直接新增 / 刪除；變更即時生效
5. **快捷管理**
   - 快捷項目：名稱、類型（支出/收入）、分類、金額、對象（JACK/WAL/餐廳/J+W）、一鍵入帳
   - 支援 **新增/覆寫、刪除、上下移動排序**
   - 按 **編輯** → 自動捲動到表單並高亮 1.5 秒
6. **系統**
   - **🔄 重置所有資料**（含確認視窗）：清除 LocalStorage / IndexedDB / Cache / Service Worker 並重載

> 備註：本版本以「簡單快速記錄」為核心，複雜的報銷沖銷、P&L 明細、跨裝置雲端同步（GitHub Pages JSON）可後續擴充。

---

## P&L 與 COGS 說明
- **P&L（損益表）**：Profit & Loss，顯示某期間的 **收入 - 成本/費用 = 淨利**。
- **COGS（銷貨成本）**：Cost of Goods Sold，指為生產/販售商品所直接發生的成本（食材、包材、飲品原料等）。
- 本版面報表提供簡要合計；如需完整 P&L（含毛利、COGS%、人事% 等），請在 `records` 資料上加上更完整計算邏輯（後續版本可提供）。

---

## 使用教學（情境式）
1. **午餐買菜 650 元（餐廳，COGS-蔬果）**
   - 記帳 → 對象選「餐廳」→ 類型「支出」→ 分類選「食材-蔬果」→ 金額 650 → 記錄
2. **熊貓外送 1,500 元（收入）**
   - 記帳 → 對象「餐廳」→ 類型「收入」→ 分類選「外送平台」→ 金額 1500 → 記錄
3. **咖啡 65 元（WAL 個人支出）做成快捷**
   - 設定 → 快捷管理：名稱「咖啡 65（WAL）」、支出、分類「餐飲（你自訂）」、金額 65、對象 WAL → 新增/覆寫
   - 之後記帳只要點 **一鍵入帳**（可在你的正式版接）即可快速送出。
4. **月底產看報表**
   - 報表 → 開啟「明細展開」與「按類型小計」查看結構。

---

## 部署
### GitHub Pages
1. 新 repo → 上傳此專案所有檔案
2. Settings → Pages → Branch 選 `main` / 根目錄，儲存
3. 首次建置後，造訪 `https://<你的帳號>.github.io/<repo>/`
4. 若畫面怪怪的，按 `Cmd/Ctrl + Shift + R` 或在網址加 `?v=16.8` 強制刷新

### Netlify / Vercel
- 新專案 → 指向此資料夾（無需 build），Publish 目錄為根目錄

---

## 檔案與資料格式
- `localStorage` keys：
  - `cashflow_cats`：分類清單
  - `cashflow_quicks`：快捷清單
  - `cashflow_records`：記帳紀錄
  - `cashflow_transfers`：轉帳紀錄
- 記帳紀錄範例：
```json
{ "ts": 1735756800000, "scope":"restaurant", "type":"expense", "category":"食材-蔬果", "amount":650, "note":"市場", "reimburse":false }
```

---

## 常見問題（FAQ）
- **Q：換手機或換電腦如何同步？**  
  A：此版為本機儲存。可在「設定」加入匯出 JSON / 匯入 JSON；或改用 GitHub Pages JSON 方式（後續版本可加）。

- **Q：COGS 是什麼？**  
  A：COGS（銷貨成本）是與製作/販售產品直接相關的成本，如食材、包材、飲品原料等。

- **Q：為何頁面沒更新？**  
  A：請清除快取或在網址加 `?v=16.8` 後重新載入。

---

## 版本記錄
- **v16.8**：可立即使用的完整正式版；加入完整預設分類、記帳/轉帳/報表、快捷管理、重置功能。
- v16.7.5：重置含確認視窗；快捷編輯自動捲動與高亮；表單手機不超出。
- v16.7.3：修復分頁渲染；快捷管理移回設定。
