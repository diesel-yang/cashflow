<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>極速記帳 v3.4</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#0aa7bb"/>
</head>
<body>
<header class="topbar">
  <div class="brand">💨 極速記帳 v3.4</div>
  <div class="space">
    <input id="space-code" placeholder="共享代號（例如 jackwal）" />
    <button id="btn-connect" class="btn sm">連線</button>
  </div>
</header>

<!-- 三口袋淨值 -->
<section class="pockets">
  <button class="pocket" data-pk="RESTAURANT">
    <div class="pocket__icon">🏪</div>
    <div class="pocket__name">餐廳</div>
    <div class="pocket__amt" id="pk-rest">—</div>
  </button>
  <button class="pocket" data-pk="JACK">
    <div class="pocket__icon">🧍</div>
    <div class="pocket__name">Jack</div>
    <div class="pocket__amt" id="pk-jack">—</div>
  </button>
  <button class="pocket" data-pk="WAL">
    <div class="pocket__icon">🧍</div>
    <div class="pocket__name">Was</div>
    <div class="pocket__amt" id="pk-wal">—</div>
  </button>
</section>

<main>
  <!-- 記帳卡片 -->
  <section class="card">
    <div class="row between">
      <div>
        <label class="check"><input type="radio" name="io" id="io-exp" checked> 支出</label>
        <label class="check"><input type="radio" name="io" id="io-inc"> 收入</label>
      </div>
      <div class="row" style="gap:8px">
        <label>日期</label>
        <input id="rec-date" type="date">
      </div>
    </div>

    <div class="row wrap" style="gap:8px">
      <label id="lbl-owner">付費口袋</label>
      <select id="rec-owner">
        <option value="RESTAURANT">餐廳</option>
        <option value="JACK">Jack</option>
        <option value="WAL">Was</option>
      </select>

      <label>付款人</label>
      <select id="rec-who">
        <option value="RESTAURANT">RESTAURANT</option>
        <option value="JACK" selected>JACK</option>
        <option value="WAL">WAL</option>
      </select>

      <label>金額</label>
      <input id="rec-amt" type="number" inputmode="decimal" placeholder="0">
    </div>

    <!-- 分類區（餐廳 / 個人） -->
    <div class="row bold">餐廳分類</div>
    <div id="cats-restaurant" class="chip-grid"></div>
    <div class="row bold" style="margin-top:6px">個人分類</div>
    <div id="cats-personal" class="chip-grid"></div>

    <!-- 選了分類後，出現項目 -->
    <div id="items-panel" class="card soft" style="display:none">
      <div class="row between">
        <div><b>選擇項目</b> <span class="muted" id="items-subtitle"></span></div>
        <small class="muted">找不到？用下方手動新增</small>
      </div>
      <div id="items-grid" class="chip-grid"></div>
      <div class="row wrap" style="gap:8px;margin-top:8px">
        <input id="rec-item" placeholder="手動新增項目名…" />
        <select id="rec-manual-cat"></select>
        <input id="rec-note" placeholder="備註（可省略）" />
        <button id="rec-submit" class="btn">送出</button>
      </div>
    </div>
  </section>

  <!-- 最近紀錄（簡版） -->
  <section class="card">
    <div class="row between"><b>最近 20 筆</b><small class="muted" id="rec-count">0</small></div>
    <ul id="recent-list" class="list"></ul>
  </section>
</main>

<footer class="ft">Made for Jack & Was · Firebase Realtime DB + 本機快取</footer>

<!-- Firebase SDK (compat 9.x) -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script src="app.js"></script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
